<!doctype html>
<html lang="ko">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width,initial-scale=1" />
  <title>ì—°ë§ ê²°ì‚° ë„ìš°ë¯¸</title>

  <!-- âœ… GA4: ì‚¬ìš©ì ì œê³µ ì½”ë“œ ê·¸ëŒ€ë¡œ (headì— 1íšŒ) -->
  <!-- Google tag (gtag.js) -->
  <script async src="https://www.googletagmanager.com/gtag/js?id=G-CD6MLMJ7B9"></script>
  <script>
    window.dataLayer = window.dataLayer || [];
    function gtag(){dataLayer.push(arguments);}
    gtag('js', new Date());
    gtag('config', 'G-CD6MLMJ7B9');
  </script>

  <style>
    :root{
      /* ğŸ„ Holiday Theme (fixed) */
      --bg:#fff6f7;
      --card:#ffffff;

      --text:#1b1b1b;
      --muted:#5d5d5d;

      --line:rgba(0,0,0,.08);

      --accent:#d12b2b;
      --accent2:#ff4a4a;

      --danger:#d12b2b;
      --ok:#0c8f47;

      --shadow: 0 16px 50px rgba(0,0,0,.08);
      --r: 18px;
      --pad: 18px;

      --font: ui-sans-serif, system-ui, -apple-system, Segoe UI, Roboto,
        "Noto Sans KR", AppleSDGothicNeo, "Malgun Gothic", Arial, sans-serif;
    }

    *{ box-sizing:border-box; }

    body{
      margin:0;
      font-family:var(--font);
      color:var(--text);
      min-height:100vh;
      display:flex;
      justify-content:center;
      padding:24px 14px 60px;

      background:
        url("data:image/svg+xml,%3Csvg xmlns='http://www.w3.org/2000/svg' width='240' height='240' viewBox='0 0 240 240'%3E%3Crect width='240' height='240' fill='none'/%3E%3Cg fill='%23ffffff' fill-opacity='0.9'%3E%3Ccircle cx='30' cy='40' r='2'/%3E%3Ccircle cx='80' cy='90' r='1.8'/%3E%3Ccircle cx='140' cy='60' r='2.2'/%3E%3Ccircle cx='200' cy='110' r='1.6'/%3E%3Ccircle cx='50' cy='160' r='2'/%3E%3Ccircle cx='120' cy='170' r='1.6'/%3E%3Ccircle cx='210' cy='190' r='2.2'/%3E%3C/g%3E%3C/svg%3E"),
        url("data:image/svg+xml,%3Csvg xmlns='http://www.w3.org/2000/svg' width='220' height='220' viewBox='0 0 220 220'%3E%3Crect width='220' height='220' fill='%23fff6f7'/%3E%3Cg opacity='0.06'%3E%3Cpath d='M0 40 L220 40' stroke='%23d12b2b' stroke-width='5'/%3E%3Cpath d='M0 110 L220 110' stroke='%23d12b2b' stroke-width='5'/%3E%3Cpath d='M0 180 L220 180' stroke='%23d12b2b' stroke-width='5'/%3E%3C/g%3E%3Cg opacity='0.04'%3E%3Cpath d='M40 0 L40 220' stroke='%23d12b2b' stroke-width='5'/%3E%3Cpath d='M110 0 L110 220' stroke='%23d12b2b' stroke-width='5'/%3E%3Cpath d='M180 0 L180 220' stroke='%23d12b2b' stroke-width='5'/%3E%3C/g%3E%3C/svg%3E"),
        linear-gradient(180deg, #fff6f7 0%, #ffeef0 100%);

      background-repeat: repeat, repeat, no-repeat;
      background-size: 240px 240px, 220px 220px, cover;
      background-attachment: fixed;
    }

    .wrap{ width:min(980px, 100%); }

    /* ============== Start Screen + App Screen Transition ============== */
    .screen{
      transition: opacity .45s ease, transform .45s ease;
      will-change: opacity, transform;
    }
    .hidden{
      opacity:0;
      transform: translateY(8px);
      pointer-events:none;
      position:absolute;
      inset:0;
    }
    .visible{
      opacity:1;
      transform: translateY(0);
      position:relative;
    }

    .start-card{
      width:min(760px, 100%);
      margin: 10px auto 0;
      background:rgba(255,255,255,.90);
      border:1px solid var(--line);
      border-radius:24px;
      box-shadow:var(--shadow);
      padding:26px 22px;
      backdrop-filter: blur(10px);
      overflow:hidden;
      position:relative;
    }
    .start-badge{
      display:inline-flex;
      align-items:center;
      gap:8px;
      padding:8px 12px;
      border-radius:999px;
      border:1px solid var(--line);
      background:rgba(255,255,255,.85);
      color:var(--muted);
      font-weight:800;
      font-size:12px;
    }
    .start-title{
      margin:14px 0 10px;
      font-size:28px;
      font-weight:1000;
      letter-spacing:-.6px;
      line-height:1.2;
    }
    .start-sub{
      margin:0 0 18px;
      color:var(--muted);
      line-height:1.6;
      font-size:14px;
    }
    .start-cta{
      display:flex;
      gap:10px;
      flex-wrap:wrap;
      align-items:center;
    }
    .start-note{
      margin-top:12px;
      color:rgba(93,93,93,.85);
      font-size:12px;
      line-height:1.6;
    }
    .start-deco{
      position:absolute;
      top:-110px;
      right:-110px;
      width:260px;
      height:260px;
      border-radius:50%;
      background: radial-gradient(circle at 30% 30%, color-mix(in srgb, var(--accent2) 25%, transparent), color-mix(in srgb, var(--accent) 18%, transparent) 35%, transparent 70%);
    }

    header{
      display:flex;
      gap:14px;
      align-items:flex-start;
      justify-content:space-between;
      margin-bottom:18px;
    }

    .brand{ display:flex; flex-direction:column; gap:6px; }

    .title{
      font-size:22px;
      font-weight:900;
      letter-spacing:-.2px;
      margin:0;
    }

    .subtitle{
      margin:0;
      color:var(--muted);
      font-size:13px;
      line-height:1.5;
    }

    .pill{
      display:inline-flex;
      align-items:center;
      gap:8px;
      padding:8px 10px;
      border:1px solid var(--line);
      border-radius:999px;
      background:rgba(255,255,255,.8);
      color:var(--muted);
      font-size:12px;
      user-select:none;
      backdrop-filter: blur(6px);
    }

    .grid{
      display:grid;
      grid-template-columns: 1.05fr .95fr;
      gap:14px;
    }
    @media (max-width:900px){ .grid{grid-template-columns:1fr} }

    .card{
      background:rgba(255,255,255,.9);
      border:1px solid var(--line);
      border-radius:var(--r);
      box-shadow:var(--shadow);
      overflow:hidden;
      backdrop-filter: blur(8px);
    }

    .card .head{
      padding:16px var(--pad);
      border-bottom:1px solid var(--line);
      display:flex;
      align-items:center;
      justify-content:space-between;
      gap:10px;
    }

    .card .head h2{
      margin:0;
      font-size:13px;
      color:var(--muted);
      font-weight:800;
      letter-spacing:-.1px;
    }

    .card .body{ padding:18px var(--pad); }

    .progress{
      display:flex;
      align-items:center;
      justify-content:space-between;
      gap:12px;
      margin-bottom:14px;
    }

    .bar{
      flex:1;
      height:10px;
      background:rgba(0,0,0,.06);
      border-radius:999px;
      overflow:hidden;
      border:1px solid rgba(0,0,0,.06);
    }

    .bar > i{
      display:block;
      height:100%;
      width:0%;
      background:linear-gradient(90deg, var(--accent), var(--accent2));
      border-radius:999px;
      transition:width .35s ease;
    }

    .pct{
      font-size:12px;
      color:var(--muted);
      min-width:86px;
      text-align:right;
    }

    .qbox{
      padding:16px;
      border-radius:14px;
      border:1px solid var(--line);
      background:
        radial-gradient(400px 120px at 20% 20%, color-mix(in srgb, var(--accent) 10%, transparent), transparent 60%),
        radial-gradient(420px 140px at 80% 30%, color-mix(in srgb, var(--accent2) 8%, transparent), transparent 60%),
        rgba(255,255,255,.75);
      margin-bottom:12px;
      transform: translateY(0);
      opacity: 1;
    }

    .qnum{ color:var(--muted); font-size:12px; margin-bottom:6px; }

    .qtext{
      margin:0;
      font-size:18px;
      font-weight:900;
      letter-spacing:-.3px;
      line-height:1.35;
    }

    textarea{
      width:100%;
      min-height:110px;
      resize:vertical;
      padding:12px 12px;
      border-radius:14px;
      border:1px solid rgba(0,0,0,.10);
      background:rgba(255,255,255,.92);
      color:var(--text);
      outline:none;
      font-size:14px;
      line-height:1.6;
      transition: box-shadow .2s ease, transform .18s ease, opacity .18s ease;
    }

    textarea:focus{
      border-color:color-mix(in srgb, var(--accent) 45%, transparent);
      box-shadow: 0 0 0 3px color-mix(in srgb, var(--accent) 14%, transparent);
    }

    .btns, .footer-tools, .mini-tools{
      display:flex;
      gap:10px;
      flex-wrap:wrap;
      margin-top:14px;
      align-items:center;
    }

    button, a.btn{
      border:1px solid rgba(0,0,0,.10);
      background:rgba(255,255,255,.92);
      color:var(--text);
      padding:10px 12px;
      border-radius:14px;
      cursor:pointer;
      font-weight:900;
      font-size:13px;
      transition: transform .05s ease, background .2s ease, border-color .2s ease, opacity .2s ease;
      user-select:none;
      text-decoration:none;
      display:inline-flex;
      align-items:center;
      gap:8px;
    }

    button:hover, a.btn:hover{
      background:#ffffff;
      border-color:rgba(0,0,0,.16);
    }

    button:active, a.btn:active{ transform: translateY(1px); }
    button:disabled{ opacity:.45; cursor:not-allowed; }

    .primary{
      color:white !important;
      background:linear-gradient(90deg, var(--accent), var(--accent2)) !important;
      border-color:color-mix(in srgb, var(--accent) 25%, transparent) !important;
    }
    .primary:hover{ filter:brightness(1.03); }

    .danger{
      color:white !important;
      background:linear-gradient(90deg, #b51f1f, var(--accent2)) !important;
      border-color:color-mix(in srgb, var(--accent) 25%, transparent) !important;
    }
    .danger:hover{ filter:brightness(1.03); }

    .ghost{
      background:transparent !important;
      border-color:rgba(0,0,0,.10) !important;
    }
    .ghost:hover{ background:rgba(255,255,255,.75) !important; }

    .side-list{
      display:flex;
      flex-direction:column;
      gap:10px;
      max-height:520px;
      overflow:auto;
      padding-right:6px;
    }

    .item{
      border:1px solid var(--line);
      background:rgba(255,255,255,.85);
      border-radius:14px;
      padding:12px;
      transition: background .35s ease, transform .2s ease, border-color .2s ease;
    }

    /* âœ… 3) ë‹µë³€ ì™„ë£Œ ì¹´ë“œ: ë°°ê²½ ì€ì€í•˜ê²Œ ë³€í™” */
    .item.answered{
      background:
        radial-gradient(520px 120px at 12% 20%, color-mix(in srgb, var(--accent2) 10%, transparent), transparent 60%),
        radial-gradient(520px 140px at 88% 70%, color-mix(in srgb, var(--accent) 9%, transparent), transparent 62%),
        rgba(255,255,255,.92);
      border-color: color-mix(in srgb, var(--accent) 14%, rgba(0,0,0,.10));
      transform: translateY(0);
    }

    .item .meta{
      display:flex;
      align-items:center;
      justify-content:space-between;
      gap:8px;
      margin-bottom:6px;
    }

    .item .meta b{ font-size:12px; color:var(--muted); }

    .tag{
      font-size:11px;
      padding:3px 8px;
      border-radius:999px;
      border:1px solid rgba(0,0,0,.10);
      color:var(--muted);
      background:rgba(255,255,255,.9);
      white-space:nowrap;
    }

    .ans{
      margin:0;
      font-size:13px;
      line-height:1.55;
      color:#222;
      white-space:pre-wrap;
      word-break:break-word;
    }

    .empty{ color:rgba(93,93,93,.75); font-style:italic; }

    .editlink{
      margin-top:8px;
      display:inline-flex;
      align-items:center;
      gap:8px;
      font-size:12px;
      font-weight:900;
      color: var(--accent);
      background: color-mix(in srgb, var(--accent) 6%, transparent);
      border:1px solid color-mix(in srgb, var(--accent) 12%, transparent);
      padding:7px 10px;
      border-radius:12px;
      cursor:pointer;
      user-select:none;
    }
    .editlink:hover{ filter:brightness(1.02); }

    .toast{
      position:fixed;
      left:50%;
      bottom:18px;
      transform:translateX(-50%);
      background:rgba(255,255,255,.95);
      border:1px solid rgba(0,0,0,.12);
      box-shadow:var(--shadow);
      color:var(--text);
      padding:10px 12px;
      border-radius:999px;
      font-size:13px;
      display:none;
      gap:10px;
      align-items:center;
      z-index:50;
      max-width:min(720px, 92vw);
    }

    .dot{
      width:9px;
      height:9px;
      border-radius:50%;
      background:var(--ok);
      box-shadow:0 0 0 3px rgba(12,143,71,.12);
      flex:0 0 auto;
    }

    details{
      border:1px solid var(--line);
      border-radius:14px;
      background:rgba(255,255,255,.85);
      padding:10px 12px;
      margin-top:12px;
    }

    summary{
      cursor:pointer;
      color:var(--muted);
      font-weight:900;
      font-size:13px;
      list-style:none;
    }
    summary::-webkit-details-marker{display:none}

    .qedit{ margin-top:10px; }
    .qedit textarea{ min-height:160px; }

    .row{
      display:flex;
      gap:10px;
      flex-wrap:wrap;
      align-items:center;
      margin-top:10px;
    }

    .row input{
      flex:1;
      min-width:240px;
      padding:10px 12px;
      border-radius:12px;
      border:1px solid rgba(0,0,0,.10);
      background:rgba(255,255,255,.92);
      color:var(--text);
      outline:none;
      font-size:13px;
    }

    .row input:focus{
      border-color:color-mix(in srgb, var(--accent) 45%, transparent);
      box-shadow: 0 0 0 3px color-mix(in srgb, var(--accent) 14%, transparent);
    }

    .icon{ width:18px;height:18px;display:inline-block;flex:0 0 auto; }
    .icon svg{ width:100%;height:100%; }

    .small{
      font-size:12px;
      color:var(--muted);
      line-height:1.6;
      margin:0;
    }

    /* âœ… 4) ë‹¤ìŒìœ¼ë¡œ ë„˜ì–´ê°ˆ ë•Œ íš¨ê³¼ */
    @keyframes nextPop {
      0%   { opacity: 0; transform: translateY(10px) scale(.985); }
      60%  { opacity: 1; transform: translateY(0) scale(1.01); }
      100% { opacity: 1; transform: translateY(0) scale(1); }
    }
    .animate-next .qbox,
    .animate-next textarea{
      animation: nextPop .38s ease both;
    }

    /* âœ… 5) ê²°ì‚° ì™„ë£Œ ì¶•í•˜ íš¨ê³¼(ì½˜í˜í‹°) */
    .confetti-layer{
      position:fixed;
      inset:0;
      pointer-events:none;
      z-index:60;
      overflow:hidden;
    }
    .confetti{
      position:absolute;
      top:-14px;
      width:10px;
      height:16px;
      border-radius:4px;
      opacity:.95;
      transform: translateY(0) rotate(0deg);
      animation: confettiFall linear forwards;
      filter: drop-shadow(0 10px 18px rgba(0,0,0,.08));
    }
    @keyframes confettiFall{
      to { transform: translateY(110vh) rotate(540deg); opacity: 1; }
    }

    .done-banner{
      margin-top:10px;
      padding:12px 14px;
      border-radius:14px;
      border:1px solid color-mix(in srgb, var(--accent) 14%, rgba(0,0,0,.10));
      background:
        radial-gradient(520px 120px at 18% 30%, color-mix(in srgb, var(--accent2) 12%, transparent), transparent 60%),
        radial-gradient(520px 140px at 82% 70%, color-mix(in srgb, var(--accent) 10%, transparent), transparent 62%),
        rgba(255,255,255,.92);
      color:#1b1b1b;
      display:none;
    }
    .done-banner b{ color: var(--accent); }
  </style>
</head>

<body>
  <div class="wrap">

    <!-- âœ… Start Screen -->
    <section id="startScreen" class="screen visible">
      <div class="start-card">
        <div class="start-deco" aria-hidden="true"></div>
        <span class="start-badge">ğŸ ì—°ë§ ê²°ì‚°</span>
        <h1 class="start-title" id="startTitle">2025ë…„ ê³ ìƒí•˜ì…¨ìŠµë‹ˆë‹¤. ì—°ë§ ê²°ì‚° ì‹œì‘í•  ì¤€ë¹„ ë˜ì…¨ë‚˜ìš”?</h1>
        <p class="start-sub">
          ì§ˆë¬¸ì´ í•˜ë‚˜ì”© ë‚˜ì™€ìš”. ë‹µí•´ë„ ë˜ê³ , ë¹„ì›Œë‘ê³  ë„˜ì–´ê°€ë„ ë©ë‹ˆë‹¤.<br/>
          ê±±ì •ë§ˆì„¸ìš”! ì‘ì„±í•œ ë‚´ìš©ì€ <b>ë‚´ ë¸Œë¼ìš°ì €ì—ë§Œ</b> ì €ì¥ë¼ìš”.
        </p>

        <div class="start-cta">
          <button class="primary" id="startBtn">ì‹œì‘í•˜ê¸°</button>
          <button class="ghost" id="exampleBtn">ì—°ë§ ê²°ì‚° ì˜ˆì‹œë³´ê¸°</button>
          <button class="ghost" id="startResetBtn" title="ì €ì¥ëœ ì§„í–‰ ìƒíƒœë¥¼ ì´ˆê¸°í™”í•©ë‹ˆë‹¤">ì €ì¥ëœ ì§„í–‰ ì´ˆê¸°í™”</button>
        </div>

        <!-- âœ… ì˜ˆì‹œ ë§í¬(ë¡œê³  í¬í•¨) -->
        <div class="start-cta" style="margin-top:10px;">
          <a class="btn" id="blogLink" target="_blank" rel="noopener">
            <span class="icon" aria-hidden="true">
              <svg viewBox="0 0 24 24" fill="none">
                <path d="M6 18V6h4l4 6V6h4v12h-4l-4-6v6H6z" fill="#03C75A"/>
              </svg>
            </span>
            ë¸”ë¡œê·¸ ì˜ˆì‹œ
          </a>

          <a class="btn" id="instaLink" target="_blank" rel="noopener">
            <span class="icon" aria-hidden="true">
              <svg viewBox="0 0 24 24" fill="none">
                <path d="M8 3h8a5 5 0 0 1 5 5v8a5 5 0 0 1-5 5H8a5 5 0 0 1-5-5V8a5 5 0 0 1 5-5Z" stroke="currentColor" stroke-width="2"/>
                <path d="M12 17a5 5 0 1 0 0-10 5 5 0 0 0 0 10Z" stroke="currentColor" stroke-width="2"/>
                <path d="M17.5 6.5h.01" stroke="currentColor" stroke-width="3" stroke-linecap="round"/>
              </svg>
            </span>
            ì¸ìŠ¤íƒ€ ì˜ˆì‹œ
          </a>

          <a class="btn" id="feedbackBtn" target="_blank" rel="noopener">
            <span class="icon" aria-hidden="true">
              <svg viewBox="0 0 24 24" fill="none">
                <path d="M4 5h16v10H7l-3 3V5Z" stroke="currentColor" stroke-width="2" stroke-linejoin="round"/>
                <path d="M8 9h8M8 12h6" stroke="currentColor" stroke-width="2" stroke-linecap="round"/>
              </svg>
            </span>
            í”¼ë“œë°± ë³´ë‚´ê¸°
          </a>
        </div>

        <p class="start-note">
          TIP: ì‹œì‘ í›„ ì˜¤ë¥¸ìª½ ëª©ë¡ì—ì„œ ì•„ë¬´ ì§ˆë¬¸ì´ë‚˜ ëˆŒëŸ¬ì„œ â€œìˆ˜ì •í•˜ê¸°â€ë¡œ ë˜ëŒì•„ê°ˆ ìˆ˜ ìˆì–´ìš”.
        </p>
      </div>
    </section>

    <!-- âœ… App Screen -->
    <section id="appScreen" class="screen hidden">
      <header>
        <div class="brand">
          <h1 class="title">ì—°ë§ ê²°ì‚° ë„ìš°ë¯¸</h1>
          <p class="subtitle">ì§ˆë¬¸ì— ë‹µí•˜ë‹¤ë³´ë©´, ì–´ëŠìƒˆ ì—°ë§ ê²°ì‚° ë! (ìˆ˜ì •/ë³µì‚¬/ìŠ¤í† ë¦¬ ì¹´ë“œ ì œì‘)</p>
        </div>
        <div class="pill" id="yearPill">ğŸ <span id="yearText"></span> ì—°ë§ ê²°ì‚°</div>
      </header>

      <!-- âœ… ìƒë‹¨ ë¯¸ë‹ˆíˆ´: í™ˆìœ¼ë¡œ / í”¼ë“œë°± (ìƒ‰ ì»¤ìŠ¤í…€ ì‚­ì œ) -->
      <div class="mini-tools">
        <button class="ghost" id="goHomeBtn">ğŸ  ì²« í™”ë©´</button>
        <a class="btn ghost" id="feedbackBtn2" target="_blank" rel="noopener">ğŸ’¬ í”¼ë“œë°±</a>
      </div>

      <div class="grid" style="margin-top:12px;">
        <!-- Left -->
        <section class="card" id="flowCard">
          <div class="head">
            <h2 id="modeTitle">ì§„í–‰</h2>
            <div class="pill">âŒ¨ï¸ <code>Ctrl</code>+<code>Enter</code> ë‹¤ìŒ</div>
          </div>
          <div class="body">
            <div class="progress">
              <div class="bar"><i id="barFill"></i></div>
              <div class="pct" id="pctText">0% Â· 0/0</div>
            </div>

            <div class="qbox" id="qBox">
              <div class="qnum" id="qNum">Q1</div>
              <p class="qtext" id="qText">ì§ˆë¬¸ì´ ì—¬ê¸°ì— í‘œì‹œë©ë‹ˆë‹¤</p>
            </div>

            <textarea id="answer" placeholder="ì—¬ê¸°ì— ë‹µë³€í•´ì¤˜! (ë¹„ì›Œë‘ê³  ë„˜ì–´ê°€ë„ ê´œì°®ì•„!)"></textarea>

            <div class="btns">
              <button class="primary" id="nextBtn">ë‹¤ìŒ</button>
              <button class="danger" id="stopBtn">ì—¬ê¸°ì„œ ë©ˆì¶”ê³  ê²°ì‚° ë³´ê¸°</button>
              <button class="ghost" id="restartBtn" title="ë‹µë³€ì€ ì´ˆê¸°í™”ë©ë‹ˆë‹¤">ì²˜ìŒë¶€í„° ë‹¤ì‹œ</button>
            </div>

            <div class="done-banner" id="doneBanner">
              ğŸ‰ <b>ì—°ë§ ê²°ì‚° ì™„ë£Œ!</b> ë‹µë³€ì„ ë³µì‚¬í•˜ê±°ë‚˜ ìŠ¤í† ë¦¬ ì¹´ë“œë¡œ ì œì‘í•  ìˆ˜ë„ ìˆì–´.
            </div>

            <!-- âœ… 6) ì»¤ìŠ¤í„°ë§ˆì´ì¦ˆ: í¼ì¹¨ ìš°ì„ (open) -->
            <details open>
              <summary>âš™ï¸ ì»¤ìŠ¤í„°ë§ˆì´ì¦ˆ (ì§ˆë¬¸/ì œëª© ë°”ê¾¸ê¸°)</summary>
              <div class="qedit">
                <p class="small">
                  - ì œëª©ì„ ë°”ê¿” ë‚˜ë§Œì˜ ì œëª©ì„ ë§Œë“¤ ìˆ˜ ìˆì–´!<br/>
                  - ê¸°ë³¸ ì§ˆë¬¸ì´ ì•„ë‹Œ ë‚˜ë§Œì˜ ì§ˆë¬¸ì„ ë§Œë“¤ ìˆ˜ ìˆì–´!(ex. ì˜¬í•´ì˜ ë°©êµ¬ëŠ”?!)<br/>
                  - ìƒˆë¡œìš´ ì§ˆë¬¸ì„ ì¶”ê°€í•˜ë©´, ê¸°ì¡´ ë‹µë³€ì´ ì´ˆê¸°í™” ë¼! ì¡°ì‹¬í•´!<br/>
                </p>
                <div class="row">
                  <input id="customTitle" placeholder="ì˜ˆ: ì—°ë§ ê²°ì‚° / ì˜¬í•´ì˜ ê¸°ë¡ / ì˜¬í•´ì˜ ê°ì‚¬ / ì˜¬í•´ì˜ ì†Œë¹„" />
                  <button id="applyTitleBtn">ì œëª© ì ìš©</button>
                </div>
                <textarea id="questionsEditor"></textarea>
                <div class="row">
                  <button id="applyQuestionsBtn">ì§ˆë¬¸ ì ìš© (ì§„í–‰ ì´ˆê¸°í™”)</button>
                  <button id="resetQuestionsBtn">ê¸°ë³¸ ì§ˆë¬¸ìœ¼ë¡œ ë³µì›</button>
                </div>
                <p class="small">* ì„œë²„ ì—†ì´ ë™ì‘: ì§„í–‰ ìƒíƒœëŠ” ë„ˆì˜ ë¸Œë¼ìš°ì €ì—ë§Œ ì €ì¥ë¼</p>
              </div>
            </details>
          </div>
        </section>

        <!-- Right -->
        <aside class="card" id="summaryCard">
          <div class="head">
            <h2>ì§€ê¸ˆê¹Œì§€ ë‹µë³€</h2>
            <div class="pill">ğŸ§¾ ìˆ˜ì • ê°€ëŠ¥</div>
          </div>
          <div class="body">
            <div class="side-list" id="sideList"></div>

            <div class="footer-tools">
              <!-- âœ… 2) ë³µì‚¬ ë²„íŠ¼ 2ê°œë¡œ ë‹¨ìˆœí™” + í˜•ì‹ í†µì¼ -->
              <button class="primary" id="copyAllBtn">ì „ì²´ ë³µì‚¬</button>
              <button class="ghost" id="copyAnsweredOnlyBtn">ë‹µë³€í•œ ê²ƒë§Œ ë³µì‚¬</button>

              <button class="danger" id="exportImageBtn" title="ë‹µë³€ ì¼ë¶€ë¥¼ ê³¨ë¼ 1080x1920 ìŠ¤í† ë¦¬ PNGë¡œ ì €ì¥">ğŸ“¸ ìŠ¤í† ë¦¬ ì¹´ë“œ ì œì‘</button>
            </div>
            <p class="small">* ì¸ìŠ¤íƒ€ ì¹´ë“œëŠ” 1080Ã—1920(ìŠ¤í† ë¦¬) PNGë¡œ ë‹¤ìš´ë¡œë“œë¼.</p>
          </div>
        </aside>
      </div>
    </section>
  </div>

  <div class="toast" id="toast">
    <span class="dot"></span>
    <span id="toastText">ë³µì‚¬ ì™„ë£Œ!</span>
  </div>

<script>
(() => {
  // =========================
  // âœ… ë„¤ê°€ ë‚˜ì¤‘ì— ë§í¬ë§Œ ë°”ê¾¸ë©´ ë¨
  // =========================
  const EXAMPLE_BLOG_URL = "https://blog.naver.com/garden_2_2/223720793794?trackingCode=blog_bloghome_searchlist";
  const EXAMPLE_INSTA_URL = "https://www.instagram.com/p/Cm0F7U4SH9C/?igsh=OGViY2FiZ29qcml4";
  const FEEDBACK_URL = "https://forms.gle/JdtPGW3zK1kDGtKp6";

  // âœ… ì €ì¥ í‚¤
  const LS_KEY = "year_review_helper_final_v2";

  // ====== ê¸°ë³¸ ì§ˆë¬¸ ì„¸íŠ¸ ======
  const DEFAULT_QUESTIONS = [
    "ì˜¬í•´ì˜ ìœ íŠœë¸ŒëŠ”?","ì˜¬í•´ì˜ ë°°ìš°ëŠ”?","ì˜¬í•´ì˜ ì˜í™”ëŠ”?","ì˜¬í•´ì˜ ì•¨ë²”ì€?","ì˜¬í•´ì˜ ë…¸ë˜ëŠ”?",
    "ì˜¬í•´ì˜ ë“œë¼ë§ˆëŠ”?","ì˜¬í•´ì˜ ì „ì‹œëŠ”?","ì˜¬í•´ì˜ ì±…ì€?","ì˜¬í•´ì˜ ì‘ê°€ëŠ”?","ì˜¬í•´ì˜ ë¬¸ì¥ì€?",
    "ì˜¬í•´ì˜ ë§ì€?","ì˜¬í•´ì˜ ì—¬í–‰ì€?","ì˜¬í•´ì˜ ìŒì‹ì€?","ì˜¬í•´ì˜ ì»¤í”¼ëŠ”?","ì˜¬í•´ì˜ ì‹ë‹¹ì€?",
    "ì˜¬í•´ì˜ ì†Œë¹„ëŠ”?","ì˜¬í•´ì˜ íˆ¬ìëŠ”?","ì˜¬í•´ì˜ ì†ì‹¤ì€?","ì˜¬í•´ì˜ êµ¬ë…ì€?","ì˜¬í•´ì˜ ìš´ë™ì€?",
    "ì˜¬í•´ì˜ ìŠµê´€ì€?","ì˜¬í•´ì˜ ê³µê°„ì€?","ì˜¬í•´ì˜ ê°ë™ì€?","ì˜¬í•´ì˜ ê±±ì •ì€?","ì˜¬í•´ì˜ ì¹œêµ¬ëŠ”?",
    "ì˜¬í•´ì˜ ì‹¤íŒ¨ëŠ”?","ì˜¬í•´ì˜ ì‹¤ìˆ˜ëŠ”?","ì˜¬í•´ì˜ ìš°ì—°ì€?","ì˜¬í•´ì˜ ë§Œë‚¨ì€?","ì˜¬í•´ì˜ ê°ì‚¬ëŠ”?"
  ];

  const normalizeText = (s) => String(s ?? "").trim().replace(/\s+/g, " ");
  const uniqueQuestions = (arr) => {
    const seen = new Set();
    const out = [];
    for(const q of arr){
      const nq = normalizeText(q);
      if(!nq) continue;
      if(seen.has(nq)) continue;
      seen.add(nq);
      out.push(nq);
    }
    return out;
  };

  // ====== DOM ======
  const startScreen = document.getElementById("startScreen");
  const appScreen = document.getElementById("appScreen");
  const startBtn = document.getElementById("startBtn");
  const startResetBtn = document.getElementById("startResetBtn");
  const exampleBtn = document.getElementById("exampleBtn");

  const blogLink = document.getElementById("blogLink");
  const instaLink = document.getElementById("instaLink");
  const feedbackBtn = document.getElementById("feedbackBtn");
  const feedbackBtn2 = document.getElementById("feedbackBtn2");

  const goHomeBtn = document.getElementById("goHomeBtn");

  const yearText = document.getElementById("yearText");
  const modeTitle = document.getElementById("modeTitle");
  const barFill = document.getElementById("barFill");
  const pctText = document.getElementById("pctText");
  const qNum = document.getElementById("qNum");
  const qText = document.getElementById("qText");
  const qBox = document.getElementById("qBox");
  const answerEl = document.getElementById("answer");
  const sideList = document.getElementById("sideList");
  const flowCard = document.getElementById("flowCard");
  const doneBanner = document.getElementById("doneBanner");

  const nextBtn = document.getElementById("nextBtn");
  const stopBtn = document.getElementById("stopBtn");
  const restartBtn = document.getElementById("restartBtn");

  const copyAllBtn = document.getElementById("copyAllBtn");
  const copyAnsweredOnlyBtn = document.getElementById("copyAnsweredOnlyBtn");
  const exportImageBtn = document.getElementById("exportImageBtn");

  const toast = document.getElementById("toast");
  const toastText = document.getElementById("toastText");

  const customTitle = document.getElementById("customTitle");
  const applyTitleBtn = document.getElementById("applyTitleBtn");
  const questionsEditor = document.getElementById("questionsEditor");
  const applyQuestionsBtn = document.getElementById("applyQuestionsBtn");
  const resetQuestionsBtn = document.getElementById("resetQuestionsBtn");

  // ====== Year ======
  const now = new Date();
  const YEAR = now.getFullYear();
  yearText.textContent = YEAR;

  // ====== Start Screen links ======
  blogLink.href = EXAMPLE_BLOG_URL;
  instaLink.href = EXAMPLE_INSTA_URL;
  feedbackBtn.href = FEEDBACK_URL;
  feedbackBtn2.href = FEEDBACK_URL;

  // ====== Utils ======
  function showToast(msg){
    toastText.textContent = msg;
    toast.style.display = "inline-flex";
    clearTimeout(showToast._t);
    showToast._t = setTimeout(()=> toast.style.display = "none", 1600);
  }

  function safeParseJSON(s){ try { return JSON.parse(s); } catch { return null; } }
  function save(state){ localStorage.setItem(LS_KEY, JSON.stringify(state)); }
  function load(){
    const raw = localStorage.getItem(LS_KEY);
    return raw ? safeParseJSON(raw) : null;
  }

  function normalizeQuestions(text){
    return uniqueQuestions(text.split("\n").map(s => s.trim()).filter(Boolean));
  }
  function esc(s){
    return (s ?? "").replace(/[&<>"']/g, (m) => ({
      "&":"&amp;","<":"&lt;",">":"&gt;","\"":"&quot;","'":"&#39;"
    })[m]);
  }

  // ====== State ======
  let state = load() || {
    title: "ì—°ë§ ê²°ì‚° ë„ìš°ë¯¸",
    questions: uniqueQuestions(DEFAULT_QUESTIONS),
    idx: 0,
    answers: {},
    skipped: {},
    stoppedAt: null,
    celebrated: false
  };

  // ====== Screen transition ======
  function goAppScreen(){
    startScreen.classList.remove("visible");
    startScreen.classList.add("hidden");

    appScreen.classList.remove("hidden");
    appScreen.classList.add("visible");

    setTimeout(()=> answerEl?.focus(), 60);
  }

  function goStartScreen(){
    appScreen.classList.remove("visible");
    appScreen.classList.add("hidden");

    startScreen.classList.remove("hidden");
    startScreen.classList.add("visible");
  }

  // âœ… 4) ë‹¤ìŒìœ¼ë¡œ ë„˜ì–´ê°ˆ ë•Œ íš¨ê³¼
  function animateNext(){
    flowCard.classList.remove("animate-next");
    // reflow
    void flowCard.offsetWidth;
    flowCard.classList.add("animate-next");
    clearTimeout(animateNext._t);
    animateNext._t = setTimeout(()=> flowCard.classList.remove("animate-next"), 450);
  }

  // âœ… 5) ê²°ì‚° ì™„ë£Œ ì¶•í•˜ íš¨ê³¼
  function fireConfetti(){
    const layer = document.createElement("div");
    layer.className = "confetti-layer";

    const colors = ["#d12b2b", "#ff4a4a", "#0c8f47", "#f2c14e", "#ffffff", "#ff7aa2"];
    const count = 70;

    for(let i=0;i<count;i++){
      const c = document.createElement("i");
      c.className = "confetti";
      const left = Math.random() * 100;
      const dur = 1.6 + Math.random() * 1.4;
      const delay = Math.random() * 0.25;
      const w = 8 + Math.random() * 8;
      const h = 12 + Math.random() * 14;

      c.style.left = left + "vw";
      c.style.width = w + "px";
      c.style.height = h + "px";
      c.style.background = colors[Math.floor(Math.random()*colors.length)];
      c.style.animationDuration = dur + "s";
      c.style.animationDelay = delay + "s";
      c.style.animationTimingFunction = "cubic-bezier(.2,.6,.2,1)";

      layer.appendChild(c);
    }

    document.body.appendChild(layer);
    setTimeout(()=> layer.remove(), 2600);
  }

  // ====== Render ======
  function setPageTitle(){
    document.title = state.title;
    document.querySelector(".title").textContent = state.title;
  }

  function renderEditor(){
    customTitle.value = state.title;
    questionsEditor.value = state.questions.join("\n");
  }

  function doneCount(){
    return Object.keys(state.answers).length + Object.keys(state.skipped).length;
  }

  function renderProgress(){
    const total = state.questions.length;
    const done = doneCount();
    const pct = total ? Math.round((done / total) * 100) : 0;
    barFill.style.width = `${pct}%`;
    pctText.textContent = `${pct}% Â· ${done}/${total}`;
  }

  function isFinished(){ return state.idx >= state.questions.length; }

  function renderQuestion(){
    const total = state.questions.length;
    const finished = isFinished();

    if(finished){
      modeTitle.textContent = "ê²°ì‚° ë³´ê¸°";
      qNum.textContent = "DONE";
      qText.textContent = "ì—°ë§ ê²°ì‚° ì™„ë£Œ! ğŸ‰ ì§§ì€ ê²°ì‚° ì•ˆì—, ë‹¤ í‘œí˜„ ëª»í•œ ë„ˆì˜ ìˆœê°„ë“¤ ê¹Œì§€ë„ ì‘ì›í•´! 2025ë…„ ì •ë§ ìˆ˜ê³ ë§ì•˜ì–´!";
      doneBanner.style.display = "block";
      answerEl.value = "";
      answerEl.disabled = true;
      nextBtn.disabled = true;
      stopBtn.disabled = true;

      // âœ… ì™„ë£Œ ì¶•í•˜(ìµœì´ˆ 1íšŒ)
      if(!state.celebrated){
        state.celebrated = true;
        save(state);
        fireConfetti();
        showToast("ì—°ë§ ê²°ì‚° ì™„ë£Œ! ğŸ‰");
      }
      return;
    }

    doneBanner.style.display = "none";
    modeTitle.textContent = "ì§„í–‰";
    answerEl.disabled = false;
    nextBtn.disabled = false;
    stopBtn.disabled = false;

    qNum.textContent = `Q${state.idx + 1}/${total}`;
    qText.textContent = state.questions[state.idx];

    const existing = state.answers[state.idx] ?? "";
    answerEl.value = existing;

    // âœ… ë‹¤ìŒ ì§„ì… ì• ë‹ˆë©”ì´ì…˜
    animateNext();
    setTimeout(() => answerEl.focus(), 0);
  }

  function renderSideList(){
    const total = state.questions.length;
    const rows = [];
    for(let i=0;i<total;i++){
      const q = state.questions[i];
      const a = state.answers[i];
      const hasAns = !!(a && a.trim());
      const isSkip = !!state.skipped[i] && (!a || a.trim()==="");

      const tag = hasAns ? "ë‹µë³€" : (isSkip ? "íŒ¨ìŠ¤" : "ë¯¸ì‘ë‹µ");
      const ansHtml =
        hasAns
          ? `<p class="ans">${esc(a)}</p>`
          : `<p class="ans empty">${isSkip ? "íŒ¨ìŠ¤ ì²˜ë¦¬ë¨" : "ì•„ì§ ë‹µë³€ ì—†ìŒ"}</p>`;

      rows.push(`
        <div class="item ${hasAns ? "answered" : ""}">
          <div class="meta">
            <b>${esc(`Q${i+1}. ${q}`)}</b>
            <span class="tag">${esc(tag)}</span>
          </div>
          ${ansHtml}
          <div class="editlink" data-edit="${i}">âœï¸ ì´ ì§ˆë¬¸ ìˆ˜ì •í•˜ê¸°</div>
        </div>
      `);
    }
    sideList.innerHTML = rows.join("");

    sideList.querySelectorAll("[data-edit]").forEach(el => {
      el.addEventListener("click", () => {
        const i = Number(el.getAttribute("data-edit"));
        jumpToQuestion(i);
      });
    });

    const answeredCount = Object.keys(state.answers)
      .filter(k => (state.answers[k] ?? "").trim().length > 0).length;
    exportImageBtn.disabled = answeredCount === 0;
  }

  function renderAll(){
    setPageTitle();
    renderEditor();
    renderProgress();
    renderQuestion();
    renderSideList();
  }

  // ====== Actions ======
  function markCurrentAnswer(){
    const total = state.questions.length;
    if(state.idx >= total) return;

    const val = (answerEl.value ?? "").trimEnd();

    if(val.trim() === ""){
      delete state.answers[state.idx];
      state.skipped[state.idx] = true;
    }else{
      state.answers[state.idx] = val;
      delete state.skipped[state.idx];
    }
  }

  function next(){
    if(isFinished()) return;
    markCurrentAnswer();
    state.idx += 1;
    save(state);
    renderAll();
  }

  function stopAndShow(){
    if(isFinished()) return;
    state.stoppedAt = state.idx;
    markCurrentAnswer();
    state.idx = state.questions.length;
    save(state);
    renderAll();
    showToast("ê²°ì‚° í™”ë©´ìœ¼ë¡œ ì´ë™!");
  }

  function restart(){
    state.idx = 0;
    state.answers = {};
    state.skipped = {};
    state.stoppedAt = null;
    state.celebrated = false;
    save(state);
    renderAll();
    showToast("ì²˜ìŒë¶€í„° ë‹¤ì‹œ ì‹œì‘!");
  }

  function jumpToQuestion(i){
    state.idx = Math.max(0, Math.min(i, state.questions.length - 1));
    answerEl.disabled = false;
    nextBtn.disabled = false;
    stopBtn.disabled = false;
    save(state);
    renderAll();
    showToast(`Q${i+1}ë¡œ ì´ë™í•´ì„œ ìˆ˜ì • ì¤‘`);
  }

  // âœ… 2) ë³µì‚¬ í¬ë§·: "ë²ˆí˜¸) ì§ˆë¬¸ - ë‹µë³€" ìœ¼ë¡œ í†µì¼
  function buildText({answeredOnly=false} = {}){
    const lines = [];
    const total = state.questions.length;

    for(let i=0;i<total;i++){
      const q = state.questions[i];
      const a = (state.answers[i] ?? "").trim();
      const isSkip = !!state.skipped[i] && !a;

      if(answeredOnly && !a) continue;

      const ansText = a ? a : (isSkip ? "(íŒ¨ìŠ¤)" : "(ë¯¸ì‘ë‹µ)");
      lines.push(`${i+1}) ${q} - ${ansText}`);
    }
    return lines.join("\n").trim() + "\n";
  }

  async function copyToClipboard(text){
    try{
      await navigator.clipboard.writeText(text);
      showToast("ë³µì‚¬ ì™„ë£Œ!");
    }catch(e){
      const ta = document.createElement("textarea");
      ta.value = text;
      document.body.appendChild(ta);
      ta.select();
      document.execCommand("copy");
      ta.remove();
      showToast("ë³µì‚¬ ì™„ë£Œ! (fallback)");
    }
  }

  // ====== Example mode ======
  function applyExample(){
    const exampleMap = {
      "ì˜¬í•´ì˜ ì˜í™”ëŠ”?": "ì–´ì©”ìˆ˜ê°€ì—†ë‹¤",
      "ì˜¬í•´ì˜ ë“œë¼ë§ˆëŠ”?": "í­ì‹¹ ì†ì•˜ìˆ˜ë‹¤",
      "ì˜¬í•´ì˜ ì±…ì€?": "ë‹ˆì½”ìŠ¤ ì¹´ì”ì°¨í‚¤ìŠ¤ - ê·¸ë¦¬ìŠ¤ì¸ ì¡°ë¥´ë°”",
      "ì˜¬í•´ì˜ ì•¨ë²”ì€?": "ì´ìƒìˆœ - Leesangsoon",
      "ì˜¬í•´ì˜ ë…¸ë˜ëŠ”?": "ë‹ˆê°€ ì ë“  ì‚¬ì´ì— ë‚˜ëŠ”",
      "ì˜¬í•´ì˜ ì—¬í–‰ì€?": "ì „ì£¼",
      "ì˜¬í•´ì˜ ì‹ë‹¹ì€?": "ì½˜ë¶€",
      "ì˜¬í•´ì˜ ì»¤í”¼ëŠ”?": "ìŠ¤íƒ ë“œì—… í”Œë¦¬ì¦ˆ",
      "ì˜¬í•´ì˜ ì†Œë¹„ëŠ”?": "í¼ì¦ 2ê°œ ê·¸ë¦¬ê³  ê½ƒê¸°ë¦°",
      "ì˜¬í•´ì˜ ë¬¸ì¥ì€?": "ì±…ì€ ë‹¹ì‹ ì„ ë‹¤ì–‘í•œ ê³³ìœ¼ë¡œ ë°ë ¤ë‹¤ ì¤€ë‹¤."
    };

    const answers = {};
    const skipped = {};
    state.questions.forEach((q, idx) => {
      if(exampleMap[q]){
        answers[idx] = exampleMap[q];
      }else{
        skipped[idx] = true;
      }
    });

    state.title = "ì—°ë§ ê²°ì‚° ë„ìš°ë¯¸ (ì˜ˆì‹œ)";
    state.answers = answers;
    state.skipped = skipped;
    state.idx = state.questions.length;
    state.stoppedAt = null;
    state.celebrated = false;

    save(state);
    renderAll();
    showToast("ì˜ˆì‹œê°€ ë¡œë“œëì–´! (ì²« í™”ë©´ìœ¼ë¡œë„ ëŒì•„ê°ˆ ìˆ˜ ìˆì–´)");
  }

  // ====== Events ======
  startBtn.addEventListener("click", () => {
    save(state);
    renderAll();
    goAppScreen();
  });

  exampleBtn.addEventListener("click", () => {
    applyExample();
    goAppScreen();
  });

  goHomeBtn.addEventListener("click", () => {
    goStartScreen();
    showToast("ì²« í™”ë©´ìœ¼ë¡œ ì´ë™!");
  });

  startResetBtn.addEventListener("click", () => {
    localStorage.removeItem(LS_KEY);
    state = {
      title: "ì—°ë§ ê²°ì‚° ë„ìš°ë¯¸",
      questions: uniqueQuestions(DEFAULT_QUESTIONS),
      idx: 0,
      answers: {},
      skipped: {},
      stoppedAt: null,
      celebrated: false
    };
    renderAll();
    showToast("ì €ì¥ëœ ì§„í–‰ì„ ì´ˆê¸°í™”í–ˆì–´!");
  });

  nextBtn.addEventListener("click", next);
  stopBtn.addEventListener("click", stopAndShow);
  restartBtn.addEventListener("click", restart);

  copyAllBtn.addEventListener("click", () => copyToClipboard(buildText({answeredOnly:false})));
  copyAnsweredOnlyBtn.addEventListener("click", () => copyToClipboard(buildText({answeredOnly:true})));

  answerEl.addEventListener("keydown", (e) => {
    if((e.ctrlKey || e.metaKey) && e.key === "Enter"){
      e.preventDefault();
      next();
    }
  });

  applyTitleBtn.addEventListener("click", () => {
    const t = (customTitle.value ?? "").trim();
    state.title = t.length ? t : "ì—°ë§ ê²°ì‚° ë„ìš°ë¯¸";
    save(state);
    renderAll();
    showToast("ì œëª© ì ìš© ì™„ë£Œ!");
  });

  applyQuestionsBtn.addEventListener("click", () => {
    const qs = normalizeQuestions(questionsEditor.value ?? "");
    if(qs.length < 1){
      showToast("ì§ˆë¬¸ì´ ìµœì†Œ 1ê°œëŠ” í•„ìš”í•´!");
      return;
    }
    state.questions = qs;
    state.idx = 0;
    state.answers = {};
    state.skipped = {};
    state.stoppedAt = null;
    state.celebrated = false;
    save(state);
    renderAll();
    showToast("ì§ˆë¬¸ ì ìš© & ì´ˆê¸°í™” ì™„ë£Œ!");
  });

  resetQuestionsBtn.addEventListener("click", () => {
    questionsEditor.value = uniqueQuestions(DEFAULT_QUESTIONS).join("\n");
    showToast("ê¸°ë³¸ ì§ˆë¬¸ìœ¼ë¡œ ë³µì›!");
  });

  // =============================
  // ğŸ“¸ ì¸ìŠ¤íƒ€ ìŠ¤í† ë¦¬ ì¹´ë“œ (1080x1920 PNG)
  // âœ… 7) íƒ€ì´í‹€ í…ìŠ¤íŠ¸: "2025 ì—°ë§ê²°ì‚°"
  // =============================
  exportImageBtn.addEventListener("click", generateInstagramStoryCard);

  function generateInstagramStoryCard(){
    const W = 1080;
    const H = 1920;
    const PAD = 92;

    const accent = "#d12b2b";
    const accent2 = "#ff4a4a";

    const answered = Object.keys(state.answers)
      .map(k => Number(k))
      .filter(i => (state.answers[i] ?? "").trim().length > 0)
      .map(i => ({ q: state.questions[i], a: String(state.answers[i]) }));

    if(answered.length === 0){
      showToast("ì•„ì§ ë‹µë³€ì´ ì—†ì–´! í•œ ê°œë¼ë„ ì‘ì„±í•´ì¤˜.");
      return;
    }

    shuffle(answered);
    const picks = answered.slice(0, Math.min(10, answered.length));

    const canvas = document.createElement("canvas");
    canvas.width = W;
    canvas.height = H;
    const ctx = canvas.getContext("2d");

    // ë°°ê²½
    ctx.fillStyle = "#fff6f7";
    ctx.fillRect(0, 0, W, H);

    radialGlow(ctx, W*0.2, H*0.18, 420, hexToRgba(accent2, 0.22));
    radialGlow(ctx, W*0.85, H*0.78, 520, hexToRgba(accent, 0.16));

    // ìŠ¤ë…¸ìš° ë„íŠ¸
    ctx.fillStyle = "rgba(255,255,255,0.95)";
    for(let i=0;i<120;i++){
      const x = Math.random() * W;
      const y = Math.random() * H;
      const r = 1.3 + Math.random()*2.4;
      ctx.beginPath();
      ctx.arc(x,y,r,0,Math.PI*2);
      ctx.fill();
    }

    // ì¹´ë“œ
    const cardX = 54, cardY = 120, cardW = W-108, cardH = H-240;
    roundRect(ctx, cardX, cardY, cardW, cardH, 30);
    ctx.fillStyle = "rgba(255,255,255,0.88)";
    ctx.fill();
    ctx.strokeStyle = "rgba(0,0,0,0.10)";
    ctx.lineWidth = 2;
    ctx.stroke();

    // íƒ€ì´í‹€
    ctx.textAlign = "left";
    ctx.fillStyle = "#1b1b1b";
    ctx.font = "900 64px sans-serif";
    ctx.fillText(`${YEAR} ì—°ë§ê²°ì‚°ğŸ`, PAD, 230);

    ctx.font = "700 30px sans-serif";
    ctx.fillStyle = "rgba(0,0,0,0.55)";
    ctx.fillText(state.title, PAD, 285);

    // ë³¸ë¬¸
    let y = 370;
    const maxWidth = W - PAD*2;

    for(const {q, a} of picks){
      ctx.font = "900 34px sans-serif";
      ctx.fillStyle = accent;
      y = wrapText(ctx, `â€¢ ${q}`, PAD, y, maxWidth, 44);

      ctx.font = "500 32px sans-serif";
      ctx.fillStyle = "#1b1b1b";
      y = wrapText(ctx, a, PAD + 18, y + 6, maxWidth - 18, 42);

      y += 18;
      if(y > H - 220) break;
    }

    // í•˜ë‹¨
    ctx.fillStyle = "rgba(0,0,0,0.55)";
    ctx.font = "700 26px sans-serif";
    ctx.fillText(`Â©Good Bye ${YEAR}`, PAD, H - 130);

    ctx.textAlign = "right";
    ctx.fillText(`#ìˆ˜ê³ í–ˆì–´ #ì—°ë§ê²°ì‚°`, W - PAD, H - 130);

    const link = document.createElement("a");
    link.download = `ì—°ë§ê²°ì‚°_${YEAR}_story.png`;
    link.href = canvas.toDataURL("image/png");
    link.click();

    showToast("ìŠ¤í† ë¦¬ ì¹´ë“œ PNG ìƒì„±!");
  }

  function hexToRgba(hex, a){
    const h = (hex || "").replace("#","").trim();
    if(h.length !== 6) return `rgba(209,43,43,${a})`;
    const r = parseInt(h.slice(0,2),16);
    const g = parseInt(h.slice(2,4),16);
    const b = parseInt(h.slice(4,6),16);
    return `rgba(${r},${g},${b},${a})`;
  }

  function radialGlow(ctx, x, y, r, color){
    const g = ctx.createRadialGradient(x,y,0,x,y,r);
    g.addColorStop(0, color);
    g.addColorStop(1, "rgba(0,0,0,0)");
    ctx.fillStyle = g;
    ctx.fillRect(0,0,ctx.canvas.width, ctx.canvas.height);
  }

  function shuffle(arr){
    for(let i = arr.length - 1; i > 0; i--){
      const j = Math.floor(Math.random() * (i + 1));
      [arr[i], arr[j]] = [arr[j], arr[i]];
    }
  }

  function wrapText(ctx, text, x, y, maxWidth, lineHeight){
    const hard = String(text).split("\n");
    for(const block of hard){
      const words = block.split(" ");
      let line = "";

      for(let n=0; n<words.length; n++){
        const testLine = line + words[n] + " ";
        const metrics = ctx.measureText(testLine);
        if(metrics.width > maxWidth && n > 0){
          ctx.fillText(line.trimEnd(), x, y);
          line = words[n] + " ";
          y += lineHeight;
        }else{
          line = testLine;
        }
      }
      ctx.fillText(line.trimEnd(), x, y);
      y += lineHeight;
    }
    return y;
  }

  function roundRect(ctx, x, y, w, h, r){
    r = Math.min(r, w/2, h/2);
    if (typeof ctx.roundRect === "function"){
      ctx.beginPath();
      ctx.roundRect(x, y, w, h, r);
      ctx.closePath();
      return;
    }
    ctx.beginPath();
    ctx.moveTo(x + r, y);
    ctx.arcTo(x + w, y, x + w, y + h, r);
    ctx.arcTo(x + w, y + h, x, y + h, r);
    ctx.arcTo(x, y + h, x, y, r);
    ctx.arcTo(x, y, x + w, y, r);
    ctx.closePath();
  }

  // ====== Start ======
  renderAll();
})();
</script>
</body>
</html>
